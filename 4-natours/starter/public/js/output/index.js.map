{"mappings":"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","sources":["starter/public/js/alert.js","starter/public/js/updateUser.js","starter/public/js/index.js","starter/public/js/stripe.js","starter/public/js/login.js"],"sourcesContent":["export const hideAlert = ()=>{\r\n     const el =document.querySelector('.alert')\r\n     if(el)el.parentElement.childNodes[0].remove();\r\n     \r\n}\r\n\r\nexport const createAlert= (message,type) =>{\r\n\r\n     const el = `<div class='alert alert--${type?'success':'error'}'>${message}</div>`\r\n     \r\n     document.querySelector(\"body\").insertAdjacentHTML('afterbegin',el)\r\n     \r\n     window.setTimeout(hideAlert,5000)\r\n    \r\n}","import axios  from 'axios'\r\nimport {createAlert} from './alert'\r\n\r\nexport const updateSetting = async (userInfo,type) =>{\r\n    const url =`/api/v1/users/${type===\"password\"?\"updatePassword\":\"updateSelf\"}`\r\n    \r\n    const data = type === \"password\"?{currentPassword:userInfo.currentPassword,newPassword:userInfo.newPassword,\r\n    confirmPassword:userInfo.confirmPassword}:\r\n          userInfo\r\n    try{\r\n    const res = await axios({\r\n        method:'patch',\r\n        url,\r\n        data\r\n    }) \r\n    if(res.data.message){\r\n        createAlert(`${type} successfully updated`,true)\r\n        location.reload(true)\r\n    }\r\n}catch(error){\r\n       createAlert(`${error.response.data.message}`,false)\r\n}   \r\n}\r\n\r\n","import {loginUser, logoutUser} from './login'\r\nimport {updateSetting, updateUserInfo} from './updateUser'\r\nimport {checkoutStripe} from './stripe'\r\n\r\n\r\n\r\nconst domElements = {\r\n    emailELement: document.querySelector('#email'),\r\n    nameELement: document.querySelector('#name'),\r\n    passwordElement: document.querySelector('#password'),\r\n    formElement: document.querySelector('.l'),\r\n    formUserELement:document.querySelector('.form-user-data'),\r\n    logOut: document.querySelector('.logout'),\r\n    currentPasswordElement: document.querySelector('#password-current'),\r\n    newPasswordElement : document.querySelector('#password'),\r\n    confirmPasswordELement: document.querySelector('#password-confirm'),\r\n    passwordFormElement:document.querySelector('.password-form'),fileUploadElement: document.getElementById('photo'),\r\n    buttonElement: document.querySelector('.checkout-button')\r\n}\r\n\r\nif(domElements.buttonElement){\r\n    domElements.buttonElement.addEventListener('click',async(e)=>{\r\n        e.target.textContent ='processing...'\r\n        \r\n        const tourID = domElements.buttonElement.dataset.tour\r\n       await  checkoutStripe(tourID)\r\n       \r\n       e.target.textContent ='Book a Tour '\r\n    })\r\n    \r\n    \r\n}\r\n\r\n\r\nif(domElements.formElement){\r\n  domElements.formElement.addEventListener('submit',(e)=>{\r\n        e.preventDefault()\r\n        emailValue = domElements.emailELement.value,\r\n        passwordValue = domElements.passwordElement.value\r\n        loginUser(emailValue,passwordValue)\r\n    })\r\n}\r\n\r\nif(domElements.logOut){\r\n    domElements.logOut.addEventListener('click',()=>{\r\n        logoutUser()\r\n    })\r\n}\r\n\r\n\r\nif(domElements.formUserELement){\r\n\r\n\r\n    domElements.formUserELement.addEventListener('submit' ,e=>{\r\n        e.preventDefault(domElements.fileUploadElement.files)\r\n\r\n        const form = new FormData()\r\n       \r\n       form.append('nameValue',domElements.nameELement.value);\r\n       form.append('emailValue',domElements.emailELement.value);\r\n       form.append('photo',domElements.fileUploadElement.files[0]);\r\n    \r\n        updateSetting(form,'data')\r\n    })\r\n\r\n}\r\nconst btn = document.querySelector('.btn-save-pass')\r\nif(btn){\r\n    btn.addEventListener('click',()=>{\r\n             btn.textContent = \"Updating Password...\"\r\n        })\r\n}\r\n \r\n        \r\nif(domElements.passwordFormElement){\r\n    domElements.passwordFormElement.addEventListener('submit', async e=>{\r\n        e.preventDefault()\r\n       const currentPassword = domElements.currentPasswordElement.value\r\n        const newPassword = domElements.newPasswordElement.value\r\n        const confirmPassword = domElements.confirmPasswordELement.value\r\n        \r\n       await updateSetting({currentPassword,newPassword,confirmPassword},'password')\r\n       \r\n        btn.textContent ='Save password'\r\n    })\r\n    \r\n}","import axios from 'axios'\r\n\r\nexport const checkoutStripe = async (tourID)=>{\r\n    \r\n    const res = await  axios({\r\n        method: 'post',\r\n        url:`/api/v1/bookings/bookings-sessions/${tourID}`\r\n        \r\n    })\r\n   window.location.replace(res.data.url)\r\n    \r\n}","/*eslint-disable*/\r\nimport axios from 'axios'\r\nimport {createAlert} from './alert'\r\n\r\nexport const loginUser = async (email,password)=>{\r\n    try{\r\n    const res = await axios({\r\n        method:'post',\r\n        url:'/api/v1/users/login',\r\n        data:{\r\n            email,\r\n            password\r\n        }\r\n    })\r\n\r\n    if(res.data.message){\r\n        createAlert(\"successfully logged in\",true)\r\n        window.setTimeout(()=>{\r\n        location.assign('/')\r\n    },150)\r\n    }\r\n}\r\n    catch(error){\r\n         createAlert(error.response.data.message, false)\r\n    }\r\n    \r\n}\r\n\r\n\r\n\r\nexport const logoutUser = async ()=>{\r\n    try{\r\n    const res= await axios(\r\n        {\r\n        method:'get',\r\n        url:'/api/v1/users/logOut',\r\n    })\r\n    console.log(res)\r\n    if(res.data.message){\r\n        if(window.location.pathname ==\"/me\"){\r\n            window.assign('/')\r\n        }\r\n        else{\r\n             location.reload(true)\r\n        }\r\n    }\r\n    }\r\n    catch(error){\r\n        createAlert('error logging out',false)\r\n    }\r\n \r\n    \r\n}\r\n\r\n\r\n\r\n"],"names":["$b5fc7adf72ceff90$export$516836c6a9dfc573","el","document","querySelector","parentElement","childNodes","remove","$b5fc7adf72ceff90$export$f631b2056a0c0baf","message","type","insertAdjacentHTML","window","setTimeout","$e4d450bed06757b7$export$87d51fc9023e4534","async","userInfo","url","data","currentPassword","newPassword","confirmPassword","$parcel$interopDefault","$dcVgj$axios","method","location","reload","error","response","$66194f8f5863386c$var$domElements","emailELement","nameELement","passwordElement","formElement","formUserELement","logOut","currentPasswordElement","newPasswordElement","confirmPasswordELement","passwordFormElement","fileUploadElement","getElementById","buttonElement","addEventListener","e","target","textContent","tourID","dataset","tour","res","replace","$c1539f492a5c7ff1$export$5ac615407820dcb3","preventDefault","emailValue","value","passwordValue","email","password","assign","$38c18d9fabac9456$export$692b4a7cc7a486ce","console","log","pathname","$38c18d9fabac9456$export$e8df664d4863167e","files","form","FormData","append","$66194f8f5863386c$var$btn"],"version":3,"file":"index.js.map","sourceRoot":"../../../../"}