var e=require("axios");function t(e){return e&&e.__esModule?e.default:e}const o=()=>{const e=document.querySelector(".alert");e&&e.parentElement.childNodes[0].remove()},a=(e,t)=>{const a=`<div class='alert alert--${t?"success":"error"}'>${e}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",a),window.setTimeout(o,5e3)},s=async(o,s)=>{const n="/api/v1/users/"+("password"===s?"updatePassword":"updateSelf"),r="password"===s?{currentPassword:o.currentPassword,newPassword:o.newPassword,confirmPassword:o.confirmPassword}:o;try{(await t(e)({method:"patch",url:n,data:r})).data.message&&(a(`${s} successfully updated`,!0),location.reload(!0))}catch(e){a(`${e.response.data.message}`,!1)}},n={emailELement:document.querySelector("#email"),nameELement:document.querySelector("#name"),passwordElement:document.querySelector("#password"),formElement:document.querySelector(".l"),formUserELement:document.querySelector(".form-user-data"),logOut:document.querySelector(".logout"),currentPasswordElement:document.querySelector("#password-current"),newPasswordElement:document.querySelector("#password"),confirmPasswordELement:document.querySelector("#password-confirm"),passwordFormElement:document.querySelector(".password-form"),fileUploadElement:document.getElementById("photo"),buttonElement:document.querySelector(".checkout-button")};n.buttonElement&&n.buttonElement.addEventListener("click",(async o=>{o.target.textContent="processing...";const a=n.buttonElement.dataset.tour;await(async o=>{const a=await t(e)({method:"post",url:`/api/v1/bookings/bookings-sessions/${o}`});window.location.replace(a.data.url)})(a),o.target.textContent="Book a Tour "})),n.formElement&&n.formElement.addEventListener("submit",(o=>{o.preventDefault(),emailValue=n.emailELement.value,passwordValue=n.passwordElement.value,(async(o,s)=>{try{(await t(e)({method:"post",url:"/api/v1/users/login",data:{email:o,password:s}})).data.message&&(a("successfully logged in",!0),window.setTimeout((()=>{location.assign("/")}),150))}catch(e){a(e.response.data.message,!1)}})(emailValue,passwordValue)})),n.logOut&&n.logOut.addEventListener("click",(()=>{(async()=>{try{const o=await t(e)({method:"get",url:"/api/v1/users/logOut"});console.log(o),o.data.message&&("/me"==window.location.pathname?window.assign("/"):location.reload(!0))}catch(e){a("error logging out",!1)}})()})),n.formUserELement&&n.formUserELement.addEventListener("submit",(e=>{e.preventDefault(n.fileUploadElement.files);const t=new FormData;t.append("nameValue",n.nameELement.value),t.append("emailValue",n.emailELement.value),t.append("photo",n.fileUploadElement.files[0]),s(t,"data")}));const r=document.querySelector(".btn-save-pass");r&&r.addEventListener("click",(()=>{r.textContent="Updating Password..."})),n.passwordFormElement&&n.passwordFormElement.addEventListener("submit",(async e=>{e.preventDefault();const t=n.currentPasswordElement.value,o=n.newPasswordElement.value,a=n.confirmPasswordELement.value;await s({currentPassword:t,newPassword:o,confirmPassword:a},"password"),r.textContent="Save password"}));
//# sourceMappingURL=index.js.map
